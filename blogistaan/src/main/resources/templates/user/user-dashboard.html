<!doctype html>
<html lang="en" xmlns:th="https://www.thymeleaf.org/">

<head>
  <meta charset="UTF-8" />
  <title th:text="${title}">Document</title>
  <meta name="description" content="">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css" integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous">

  <link rel="stylesheet" th:href="@{/css/user-dashboard.css}" href="" />
  <link rel="stylesheet" th:href="@{/css/templatemo-main.css}" />
  <link rel="stylesheet" th:href="@{/css/bootstrap.min.css}">
  <link rel="stylesheet" th:href="@{/css/fontAwesome.css}">
  <link rel="stylesheet" th:href="@{/css/hero-slider.css}">
  <link rel="stylesheet" th:href="@{/css/owl-carousel.css}">


  <script src="https://code.jquery.com/jquery-3.5.1.min.js" crossorigin="anonymous"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  <script src="https://kit.fontawesome.com/fc383a6465.js" crossorigin="anonymous"></script>
</head>

<body>

  <div th:insert="fragments/fragment-file :: navbarTopAndSide"></div>
  
  
  
<div th:if="${message}" style="padding-left:300px; padding-top:100px;">
<h1  th:text="${message.content}"></h1>
</div>
<div th:unless="${message}" style="padding-top:80px; margin:30px; margin-left:250px;">
<input type="hidden" name="bId" th:value="${blog1.bId}" >
<table class="table table-striped" style=" background-color: #fff">
  <thead>
    <tr>
      <th scope="col">ID</th>
      <th scope="col">Title</th>
      <th scope="col">Date</th>
      <th scope="col">Action</th>
    </tr>
  </thead>
  <tbody>
    <tr th:each="p: ${posts}">
      <th scope="row" th:text="${'SCMUSER'+p.postId}"></th>
      <!-- <td > <img class="image-size" th:src="@{'/images/' + ${c.cId}+ '/' + ${c.image}}" alt="" /> -->
      <!-- <form method="post" th:action="@{'/user/userProfile/'+${c.cId}}">
      <button><span th:text="${c.name}" ></span></button> 
      </form> -->
      <!-- </td> -->
      <td th:text="${p.title}"></td>
      <td th:text="${p.date}"></td>
      <td><form th:action="@{'/user/' + ${bId} + '/edit/'+${p.postId}}" method="POST"><button type="submit">Edit</button></form></td>
    </tr>
    
  </tbody>
</table>
</div>

<!-- <div th:if="${blog1}" style="padding-left:300px; padding-top:100px;"> <h1 th:text="${blog1.bId}"></h1>
<h1 th:text="${blog1.blogName}"></h1>
<h1 th:text="${blog1.blogUrl}"></h1>
</div> -->

<!-- <div th:if="${posts}" th:each="post: ${posts}" style="padding-left:300px; padding-top:100px;"> <h1 th:text="${post.postId}"></h1>
<h1 th:text="${post.title}"></h1>
<h1 th:text="${post.content}"></h1>
<h1 th:text="${post.date}"></h1>
</div> -->

<div class="hover_bkgr_fricc  contact-formation">
    <span class="helper"></span>
    <div class="cetr">
        <div class="popupCloseButton">&times;</div>
        <h2>Please fill the mentioned details for your blog</h2>
        <label for="blog_field">Your Blog Name</label>
        <input type="text"  class="contact-formation-text" id="name_field" name="name" placeholder="Enter your blog name" required="required">
        
        <div style="display:none;" id="namediv1">
	    <label id="namedisplay1" ></label> 
	    <br />
	    </div>
        
        <label for="blog_field">Your Blog URL</label>
        <input type="text"  class="contact-formation-text" id="url_field" name="blogUrl" placeholder="Enter your blog url" required="required">
        
      <!--  <label id="res_message" style="display:none;"></label>  -->
       
       <div style="display:none;" id="namediv">
	    <label id="namedisplay" ></label> 
	    <br />
	    </div>
        
        <label for="country_field">Category</label>
        <div class="input_field select_option contact-formation-text backcol">
          <select required="required" class=" contact-formation-text1" name="category" id="category" >
            <option value="" >Select a category</option>
            <option value="Business">Business</option>
            <option value="Fashion">Fashion</option>
            <option value="Finance">Finance</option>
            <option value="Fitness">Fitness</option>
            <option value="Food">Food</option>
            <option value="Lifestyle">Lifestyle</option>
            <option value="Africa">Music</option>
            <option value="Personal">Personal</option>
            <option value="Political">Political</option>
            <option value="Travel">Travel</option>
            <option value="Sports">Sports</option>
            <option value="Other">Other</option>
          </select>
          <!-- <div class="select_arrow"></div> -->
        </div>
        <div class="btn_wrapper" >
		  <button class="btn btn-outline-dark btns" disabled="disabled">Submit</button>
		</div>
    </div>
</div>



<!-- <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
    <script>window.jQuery || document.write('<script th:src="@{js/vendor/jquery-1.11.2.min.js}"><\/script>')</script>
    <script th:src="@{/js/vendor/bootstrap.min.js}"></script>
    <script th:src="@{/js/plugins.js}"></script>
    <script th:src="@{/js/main.js}"></script> -->
    
    <script th:inline="javascript">
						
						$(document).ready(function() {
						    $(".trigger_popup_fricc").click(function(){
						       $('.hover_bkgr_fricc').show();
						    });
						   /*  $('.hover_bkgr_fricc').click(function(){
						        $('.hover_bkgr_fricc').hide();
						    }); */
						    $('.popupCloseButton').click(function(){
						        $('.hover_bkgr_fricc').hide();
						    });
						    
						   /*  $(".btn_wrapper").hide(); */						    $('#url_field').keyup(function(){
						    	var blogUrl = $('#url_field').val();
							    var url = "/user/checkBlogUrl";
							   /*  var str = $('#url_field').val(); */
							    var regex = /^[A-Za-z0-9]+$/;
							    if(!$("#url_field").val()){
						    		$("#namedisplay").empty();
						    		$("#namediv").hide();
						    		/* $(".btn_wrapper").hide(); */
						    		$(".btns").prop('disabled', true);
						    	}
							    else if(regex.test(blogUrl) == false) {
							       /*  alert('illegal characters.'); */
							    	$("#namediv").show();
									$("#namedisplay").empty();
									$("#namedisplay").append("Illegal character");
						    		/* $(".btn_wrapper").hide(); */
									$(".btns").prop('disabled', true);
							    }
							    else{
							    	/* $(".btn_wrapper").show(); */
							    	$(".btns").prop('disabled', false);
							    	$.ajax({
								    	url: url,
								    	type: "POST",
								    	data: {
								    		blogUrl: blogUrl
								    	},
								    	success : function(response){
								    		$("#namediv").show();
	    									$("#namedisplay").empty();
	    									$("#namedisplay").append(response);
	    									var str = response;
	    									if(str.includes("unavailable")){
	    							    	/* 	$(".btn_wrapper").hide(); */
	    							    	
	    										$(".btns").prop('disabled', true);
	    									}
								    		
								    	},
								    	error : function(){
								    		alert("error message: "+ response);
								    		console.log(response);
								    	}
								    });
								    
							    }
						    });
						   $("#name_field").keyup(function(){
							   var c = $('#name_field').val()[0];
							   console.log("Consolelog:  "+ c);
							   var name = $('#name_field').val();
							   var regex = /^[A-Za-z0-9 -_]+$/;
							   var splchar = /^[A-Za-z0-9]+$/;
							   if(!$("#name_field").val()){
						    		$("#namedisplay1").empty();
						    		$("#namediv1").hide();
						    		/* $(".btn_wrapper").hide(); */
						    		$(".btns").prop('disabled', true);
						    	}
							   else if( (splchar.test($('#name_field').val()[0]) == false) || (regex.test(name) == false)  ) {
							       /*  alert('illegal characters.'); */
							    	$("#namediv1").show();
									$("#namedisplay1").empty();
									$("#namedisplay1").append("Illegal character");
						    		/* $(".btn_wrapper").hide(); */
									$(".btns").prop('disabled', true);
							    }
							   else{
								   $("#namediv1").hide();
								   $(".btns").prop('disabled', false);
							   }
						   });
						   
						  $('.btns').click(function(){
							  alert();
							  var blogName = $('#name_field').val();
							  var blogUrl = $('#url_field').val();
							  var category = $('#category').val();
							  $.ajax({
								  url : "/user/createBlog",
								  type : "POST",
								  async: false,
								  data : {
									  blogName : blogName,
									  blogUrl : blogUrl,
									  category : category
								  },
								  success : function(response){
									  /* console.log("success: " + response); */
									  window.location = '/user/index';
								  },
								  error : function(){
									  console.log("error: "+ response);
								  }
							  });
						  });
						    
						});
						
						</script>
    
</body>
</html>